# address_DB

## 総務省 全国地方公共団体コード

総務省のWebページで得られるデジタルデータを
Rで扱うためのスクリプトを公開しています。

[http://www.soumu.go.jp/denshijiti/code.html](http://www.soumu.go.jp/denshijiti/code.html)

## データファイルの準備

総務省のデータは、Excel形式なので、
シート毎にCSVファイルとして保存しなおすことでCSVファイルを得ることが出来ます。

### 都道府県コード及び市区町村コード

Excelファイルをダウンロード（00061853.xls）

Excelを開くと、「R1.5.1現在の団体」シートと、「H30.10.1政令指定都市」シートという２つのシートがあるので、ひとつづつ開いて、名前を付けて保存を選びます。
そして、ファイルの形式を「Excdl97-2003ブック」となっている部分をクリックして、
現れる一覧から「CSV UTF-8（コンマ区切り）（*.csv）」を選択します。
また、ファイル名（00061853等となっている）を、「R1.5.1現在の団体」については、`cities`に変更、「H30.10.1政令指定都市」については、`big_cities`に変更します。


### 「都道府県コード及び市区町村コード」改正一覧表
Excelファイルをダウンロード（000562731.xls）

Excelを開くと、「改正一覧表」シートという２つのシートがあります。
名前を付けて保存を選びます。
そして、ファイルの形式を「Excdl97-2003ブック」となっている部分をクリックして、
現れる一覧から「CSV UTF-8（コンマ区切り）（*.csv）」を選択します。
ファイル名（000562731等となっている）を、`history`に変更します。

## データベースデータの作成

事前に、スクリプト`make_DB.R`を開いて、各必要ファイルのパス等、
その内容を確認します。

スクリプトを実行します。

```
# スクリプト実行例
source("make_DB.R")
```

`data_dist`ディレクトリの中に、`cities_db.rda`が出来ています。

このファイルをR環境で読み込めば、その環境内で、データフレームデータとしてデータを使うことが出来ます。

```
# ファイル読み込み例
load("cities_db.rda")
```

## その他

地名の読みについては、カタカナとひらがなが混在しています。


